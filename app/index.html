<!DOCTYPE html>
<html>

<head>
    <script src="bower_components/webcomponentsjs/webcomponents.min.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js" type="text/javascript"></script>
    <script src="../lib/skulpt.js"></script>
    <script src="../lib/skulpt-stdlib.js"></script>


    <link rel="import" href="elements/pixi-element.html">
    <link rel="import" href="elements/python-element.html">
    <link href="../bower_components/core-scaffold/core-scaffold.html" rel="import">
    <link href="../bower_components/core-animated-pages/core-animated-pages.html" rel="import">
    <link href="../bower_components/core-icon/core-icon.html" rel="import">
    <link href="../bower_components/core-icons/core-icons.html" rel="import">
    <link href="../bower_components/core-ajax/core-ajax.html" rel="import">
    <link href="../bower_components/paper-button/paper-button.html" rel="import">
    <link href="../bower_components/paper-fab/paper-fab.html" rel="import">


    <link rel="import" href="../bower_components/core-header-panel/core-header-panel.html">
    <link rel="import" href="../bower_components/core-menu/core-menu.html">
    <link rel="import" href="../bower_components/core-item/core-item.html">
</head>

<body unresolved>

    <core-scaffold responsiveWidth="1000px" drawerWidth="150px">

        <div tool flex id="toolbar" >toolbar</div>
        <core-header-panel navigation flex mode="seamed">
            <core-toolbar style="background-color: #526E9C; color: #fff;">
                <span flex>Title</span>
            </core-toolbar>
            <core-menu>
                <core-item icon="settings" label="game" onclick="selectPage(0)"></core-item>
                <core-item icon="settings" label="code" onclick="selectPage(1)"></core-item>
            </core-menu>
        </core-header-panel>

        <core-animated-pages flex transitions="cross-fade-all">
            <section>
                <div layout vertical center center-justified>
                    <paper-fab id="run_top" style="position: absolute; top:10px; left:10px; color: #fff;" icon="arrow-forward" title="run" role="button" aria-label="arrow-forward"></paper-fab>
                    <pixi-element></pixi-element>
                </div>
            </section>
            <section>
                <div vertical layout flex>
                    <textarea id="code" rows="40">
                        loading.........
                    </textarea>
                    <paper-button raised id="run">
                        <core-icon icon="favorite"></core-icon>
                        execute
                    </paper-button>
                </div>
                <python-element flex></python-element>
            </section>
        </core-animated-pages>

    </core-scaffold>

    <core-ajax auto="" url="code/code.py" handleas="text" hidden=""></core-ajax>

    <script type="text/javascript">
    function runGame(event) {
        document.querySelector('pixi-element').resetCanvas();
        var py = document.querySelector('python-element');
        py.run(document.querySelector('#code').value);
    }
    function selectPage(page){
      var p = document.querySelector('core-animated-pages');
      p.selected=page;
    }
    window.addEventListener('polymer-ready', function(e) {
        var ajax = document.querySelector("core-ajax");
        ajax.addEventListener("core-response", function(e) {
            document.querySelector('#code').value = e.detail.response;
        });
        document.querySelector('#run').addEventListener("click",runGame);
        document.querySelector('#run_top').addEventListener("click",runGame);

        // var ch=window.innerHeight-64;
        // document.querySelector('pixi-element').resize(ch*1.1,ch);
    });
    </script>
</body>

</html>
